{"version":3,"sources":["../../src/pages/excel/exceleditor/exceleditor.ts","../../src/pages/excel/exceleditor/exceleditor.module.ts"],"names":[],"mappings":"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","file":"93.js","sourcesContent":["import { Component } from '@angular/core';\nimport { Events, IonicPage, NavController, NavParams, ToastController } from 'ionic-angular';\nimport { HttpServicesProvider } from '../../../providers/http-services';\nimport { PhoneDeviceProvider } from '../../../providers/phone-device';\n\n/**\n * Generated class for the ExceleditorPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-exceleditor',\n  templateUrl: 'exceleditor.html',\n})\nexport class ExceleditorPage {\n  // 默认自动保存间隔\n  public defaultAutoSaveInterval = 1000 * 30\n  // 空模版配置\n  public defaultOption = {\n    container: 'luckysheet', // 设定DOM容器的id\n    lang: 'zh', // 设定表格语言\n    \"row\": 5, //行数\n    \"column\": 5, //列数\n    \"defaultRowHeight\": 32, //自定义行高\n    \"defaultColWidth\": 78, //自定义列宽\n    data: [{ \"name\": \"Sheet1\" }]\n  }\n  // 移动端纯净配置,只保留表格内容\n  public cleanLuckySheelOption = {\n    sheetFormulaBar: false,\n    showstatisticBar: false,\n    showsheetbar: false,\n    enableAddBackTop: false,\n    showinfobar: false,\n    showstatisticBarConfig: {\n      zoom: true,\n    },\n    rowHeaderWidth: 0, // 行标题宽度\n    columnHeaderHeight: 0, // 列标题高度\n    showtoolbar: false\n  }\n  public isLoadEmptyTemplate = false\n  public options: any\n  public jsonObj: object\n  public timer: any\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, public httpService: HttpServicesProvider, public phoneDevice: PhoneDeviceProvider, public events: Events, public toastCtrl: ToastController) {\n    // this.phoneDevice.phoneBacktoPop(this.navCtrl);\n    this.options = this.navParams.get('options');\n    console.log(`constructor  this.options => `, this.options)\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad ExceleditorPage');\n  }\n\n  ionViewWillEnter() {\n    const { jsonStr, autoSaveInterval } = this.options\n\n    if (jsonStr) {\n      this.jsonObj = JSON.parse(jsonStr.replace(/&nbsp;/g, ' '))\n      console.log(`ionViewWillEnter  this.jsonObj => `, this.jsonObj)\n      console.log({\n        ...this.jsonObj,\n        ...this.cleanLuckySheelOption\n      });\n      \n      // 读取数据\n      window['luckysheet'].create({\n        ...this.jsonObj,\n        ...this.cleanLuckySheelOption\n      });\n    } else {\n      this.isLoadEmptyTemplate = true\n      // 加载空模版\n      window['luckysheet'].create({\n        ...this.defaultOption,\n        ...this.cleanLuckySheelOption\n      });\n    }\n\n    // 定时提交\n    this.timer = setInterval(() => {\n      this.commitExcelJson()\n    }, autoSaveInterval || this.defaultAutoSaveInterval)\n  }\n\n  ionViewWillUnload() {\n    console.log('ionViewWillUnload ExceleditorPage');\n    if (this.timer) {\n      clearInterval(this.timer)\n    }\n  }\n\n  commitExcelJson(saveAndBack = false) {\n    const { saveCallback } = this.options\n\n    const exceldata = window['luckysheet'].toJson().data\n    // 去除没用的数据\n    delete exceldata[0].data\n    delete exceldata[0].luckysheet_select_save\n    delete exceldata[0].visibledatacolumn\n    delete exceldata[0].visibledatarow\n    // console.log(`commitExcelJson  exceldata => `, exceldata)\n\n    let emitData\n    if (this.isLoadEmptyTemplate) {\n      // 是空模版时，直接返回excel数据\n      emitData = exceldata\n    } else {\n      // 有初始数据，还原原来的配置数据，只改变cell数据\n      emitData = {\n        ...this.jsonObj,\n        data: exceldata\n      }\n    }\n    // console.log(emitData);\n\n    if (typeof saveCallback == 'function') {\n      saveCallback(JSON.stringify(emitData))\n    }\n    saveAndBack && this.back()\n  }\n\n  back() {\n    this.navCtrl.pop()\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/excel/exceleditor/exceleditor.ts","import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ExceleditorPage } from './exceleditor';\n\n@NgModule({\n  declarations: [\n    ExceleditorPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ExceleditorPage),\n  ],\n})\nexport class ExceleditorPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/excel/exceleditor/exceleditor.module.ts"],"sourceRoot":""}