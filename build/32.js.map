{"version":3,"sources":["../../src/pages/me/securityset/securityset.ts","../../src/pages/me/securityset/securityset.module.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAA0C;AACgG;AAClE;AACX;AACmB;AAEhF;;;;;GAKG;AAOH;IAGE,yBAAmB,OAAsB,EAChC,SAAoB,EACpB,WAAgC,EAChC,OAAuB,EACvB,SAAyB,EACzB,QAAiB,EACjB,MAAa,EACb,KAAsB,EACtB,SAAyB,EACzB,SAAyB,EACzB,sBAA8C,EAC9C,GAAO;QAXhB,iBAmCC;QAnCkB,YAAO,GAAP,OAAO,CAAe;QAChC,cAAS,GAAT,SAAS,CAAW;QACpB,gBAAW,GAAX,WAAW,CAAqB;QAChC,YAAO,GAAP,OAAO,CAAgB;QACvB,cAAS,GAAT,SAAS,CAAgB;QACzB,aAAQ,GAAR,QAAQ,CAAS;QACjB,WAAM,GAAN,MAAM,CAAO;QACb,UAAK,GAAL,KAAK,CAAiB;QACtB,cAAS,GAAT,SAAS,CAAgB;QACzB,cAAS,GAAT,SAAS,CAAgB;QACzB,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,QAAG,GAAH,GAAG,CAAI;QAbT,aAAQ,GAAQ,EAAE,CAAC;QAetB,IAAI,CAAC,QAAQ,CAAC,wBAAwB,CAAC;YACrC,KAAI,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;QACH,IAAI,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,2EAAe,CAAC,iBAAiB,CAAC,CAAC;QACzE,EAAE,EAAC,cAAc,IAAE,IAAI,CAAC,EAAC;YACvB,IAAI,OAAO,GAAE,cAAc,CAAC,OAAO,CAAC;YACpC,IAAI,eAAe,GAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,2EAAe,CAAC,oBAAoB,CAAC,CAAC;YAC3E,EAAE,EAAC,eAAe,IAAE,IAAI,CAAC,EAAC;gBACxB,EAAE,EAAC,OAAO,IAAE,eAAe,CAAC,OAAO,CAAC,EAAC;oBACnC,IAAI,CAAC,SAAS,GAAC,IAAI,CAAC;gBACtB,CAAC;gBAAA,IAAI,EAAC;oBACJ,IAAI,CAAC,SAAS,GAAC,KAAK,CAAC;gBACvB,CAAC;YACH,CAAC;YAAA,IAAI,EAAC;gBACJ,IAAI,CAAC,SAAS,GAAC,KAAK,CAAC;YACvB,CAAC;YACD,oBAAoB;QACtB,CAAC;QAAA,IAAI,EAAC;YACJ,IAAI,CAAC,SAAS,GAAC,KAAK,CAAC;QACvB,CAAC;IAGL,CAAC;IAED,wCAAc,GAAd;QACE,OAAO,CAAC,GAAG,CAAC,gCAAgC,CAAC,CAAC;QAC9C,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,mBAAmB,CAAC,CAAC;IAC/C,CAAC;IACD,wCAAc,GAAd;QAAA,iBAyCC;QAxCC,IAAI,IAAI,GAAC,EAAC,EAAE,EAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,2EAAe,CAAC,WAAW,CAAC,CAAC,EAAE;YAClD,WAAW,EAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,2EAAe,CAAC,iBAAiB,CAAC,CAAC,QAAQ;SACxE,CAAC;QACZ,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,mBAAmB,EAAC,UAAC,IAAI;YAC7C,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBACpB,OAAO,EAAC,IAAI;gBACZ,QAAQ,EAAC,IAAI;gBACb,QAAQ,EAAC,KAAK;aACf,CAAC,CAAC,OAAO,EAAE,CAAC;YACb,gDAAgD;QAClD,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,eAAe,EAAC;YACpC,IAAI,GAAG,GAAC,SAAS,CAAC;YACX,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,EAAC,IAAI,EAAC,UAAC,IAAI;gBACnC,EAAE,EAAC,IAAI,CAAC,IAAI,IAAE,CAAC,CAAC,EAAC;oBACb,KAAI,CAAC,SAAS,CAAC,MAAM,CAAC;wBACpB,KAAK,EAAC,MAAM;wBACZ,QAAQ,EAAC,eAAe;wBACxB,QAAQ,EAAC,YAAY;wBACrB,OAAO,EAAC,CAAC;gCACP,IAAI,EAAC,IAAI;gCACT,OAAO,EAAC;oCACN,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,WAAW,CAAC,CAAC;oCACjD,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,iBAAiB,CAAC,CAAC;oCACvD,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,iBAAiB,CAAC,CAAC;oCACvD,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,aAAa,CAAC,CAAC;oCACnD,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,cAAc,CAAC,CAAC;oCACpD,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,eAAe,CAAC,CAAC;oCACrD,uDAAuD;oCACvD,KAAI,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;oCAC3C,KAAI,CAAC,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC;gCAC3C,CAAC;6BACF,CAAC;qBACH,CAAC,CAAC,OAAO,EAAE,CAAC;gBAEjB,CAAC;YACH,CAAC,EAAC,IAAI,CAAC,CAAC;QAChB,CAAC,CAAC;QACF,IAAI,KAAK,GAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,0BAA0B,EAAC,EAAC,UAAU,EAAC,IAAI,EAAC,CAAC,CAAC;QACpF,KAAK,CAAC,OAAO,EAAE,CAAC;IAClB,CAAC;IAED,oCAAU,GAAV,UAAW,KAAK;QACd,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QAC3B,EAAE,EAAC,KAAK,CAAC,OAAO,CAAC,EAAC;YAChB,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,IAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACzD,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YACnC,CAAC;QACH,CAAC;QAAA,IAAI,EAAC;YACF,IAAI,CAAC,SAAS,GAAC,KAAK,CAAC;YACrB,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,oBAAoB,CAAC,CAAC;YAC1D,IAAI,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;gBAC1B,OAAO,EAAE,WAAW;gBACpB,QAAQ,EAAE,QAAQ;gBAClB,QAAQ,EAAE,IAAI;aACf,CAAC;YACF,GAAG,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC;IACH,CAAC;IAGD,QAAQ;IACR,sCAAY,GAAZ,UAAa,MAAM;QAAnB,iBAqEC;QApEC,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,UAAC,GAAG;YACjD,EAAE,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC;gBACpB,IAAI,gBAAc,GAAG,KAAI,CAAC,OAAO,CAAC,GAAG,CAAC,2EAAe,CAAC,iBAAiB,CAAC,CAAC;gBACzE,EAAE,CAAC,CAAC,gBAAc,IAAI,IAAI,CAAC,CAAC,CAAC;oBAC3B,IAAI,aAAa,GAAG;wBAClB,QAAQ,EAAE,YAAY;wBACtB,QAAQ,EAAE,gBAAc,CAAC,OAAO;wBAChC,QAAQ,EAAE,gBAAc,CAAC,QAAQ;wBACjC,MAAM,EAAC,OAAO;wBACd,WAAW,EAAC,CAAC;wBACb,aAAa,EAAC,IAAI;wBAClB,WAAW,EAAC,QAAQ;qBACrB;oBACD,KAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,gBAAM;wBAC5D,EAAE,CAAC,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC;4BAC3B,IAAI,UAAU,GAAC;gCACb,OAAO,EAAE,gBAAc,CAAC,OAAO;gCAC/B,QAAQ,EAAE,gBAAc,CAAC,QAAQ;gCACjC,KAAK,EAAC,MAAM,CAAC,KAAK;6BACnB;4BACD,KAAI,CAAC,OAAO,CAAC,GAAG,CAAC,2EAAe,CAAC,oBAAoB,EAAC,UAAU,CAAC,CAAC;4BAClE,KAAI,CAAC,SAAS,GAAC,IAAI,CAAC;4BACpB,IAAI,GAAG,GAAG,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC;gCAC1B,OAAO,EAAE,WAAW;gCACpB,QAAQ,EAAE,QAAQ;gCAClB,QAAQ,EAAE,IAAI;6BACf,CAAC;4BACF,GAAG,CAAC,OAAO,EAAE,CAAC;wBAChB,CAAC;wBAAA,IAAI,EAAC;4BACJ,KAAI,CAAC,SAAS,GAAC,KAAK,CAAC;4BACrB,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,oBAAoB,CAAC,CAAC;4BAC1D,IAAI,GAAG,GAAG,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC;gCAC1B,OAAO,EAAE,UAAU;gCACnB,QAAQ,EAAE,QAAQ;gCAClB,QAAQ,EAAE,IAAI;6BACf,CAAC,CAAC;4BACH,GAAG,CAAC,OAAO,EAAE,CAAC;wBAChB,CAAC;oBACH,CAAC,EAAC,eAAK;wBACL,KAAI,CAAC,SAAS,GAAC,KAAK,CAAC;wBACrB,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,oBAAoB,CAAC,CAAC;wBAC1D,EAAE,CAAC,CAAC,KAAK,KAAK,KAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC,CAAC;4BACrE,OAAO,CAAC,GAAG,CAAC,mCAAmC,CAAC,CAAC;wBACrD,CAAC;wBAAA,IAAI,CAAC,EAAE,EAAC,KAAK,KAAK,KAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,iBAAiB,CAAC,EAAC;4BACrE,IAAI,GAAG,GAAG,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC;gCAC1B,OAAO,EAAE,QAAQ;gCACjB,QAAQ,EAAE,QAAQ;gCAClB,QAAQ,EAAE,IAAI;6BACf,CAAC;4BACF,GAAG,CAAC,OAAO,EAAE,CAAC;wBAClB,CAAC;wBAAA,IAAI,CAAC,CAAC;4BACH,OAAO,CAAC,GAAG,CAAC,yBAAyB,GAAG,KAAK,CAAC,CAAC;wBACnD,CAAC;oBACH,CAAC,CAAC;gBACJ,CAAC;YACH,CAAC;YAAA,IAAI,EAAC;gBACJ,KAAI,CAAC,SAAS,GAAC,KAAK,CAAC;gBACrB,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,2EAAe,CAAC,oBAAoB,CAAC,CAAC;YAC5D,CAAC;QACH,CAAC,CAAC,CAAC,KAAK,CAAC,eAAK;YACZ,KAAI,CAAC,SAAS,GAAC,KAAK,CAAC;YACrB,IAAI,GAAG,GAAG,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC;gBAC1B,OAAO,EAAE,UAAU;gBACnB,QAAQ,EAAE,QAAQ;gBAClB,QAAQ,EAAE,IAAI;aACf,CAAC,CAAC;YACH,GAAG,CAAC,OAAO,EAAE,CAAC;QAChB,CAAC,CAAC;IACJ,CAAC;IAhLU,eAAe;QAJ3B,gEAAS,CAAC;YACT,QAAQ,EAAE,kBAAkB;WACG;SAChC,CAAC;6EAIyC;YACrB,sFAAS;YACR,4EAAoB;YACxB,sEAAe;YACb,gEAAe;YAChB,8DAAQ;YACV,sEAAM;YACN,sEAAe;YACZ,sEAAe;YACf,sGAAe;YACD,4DAAsB;YAC1C,GAAG;OAdL,eAAe,CAiL3B;IAAD,CAAC;AAAA;SAjLY,eAAe,e;;;;;;;;;;;;;;;;;;;AClBa;AACO;AACA;AAUhD;IAAA;IAAoC,CAAC;IAAxB,qBAAqB;QARjC,+DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,qEAAe;aAChB;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,qEAAe,CAAC;aAC1C;SACF,CAAC;OACW,qBAAqB,CAAG;IAAD,4BAAC;CAAA;AAAH","file":"32.js","sourcesContent":["import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Modal, ModalController, Platform, Events, ToastController, AlertController, App } from 'ionic-angular';\nimport { HttpServicesProvider } from '../../../providers/http-services';\nimport { StorageProvider } from '../../../providers/storage';\nimport { AndroidFingerprintAuth } from '@ionic-native/android-fingerprint-auth';\n\n/**\n * Generated class for the SecuritysetPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-securityset',\n  templateUrl: 'securityset.html',\n})\nexport class SecuritysetPage {\n  public password:string='';\n  public fingerval;\n  constructor(public navCtrl: NavController, \n    public navParams: NavParams,\n    public httpService:HttpServicesProvider,\n    public storage:StorageProvider,\n    public modalCtrl:ModalController,\n    public platform:Platform,\n    public events:Events,\n    public toast: ToastController,\n    public toastCtrl:ToastController,\n    public alertCtrl:AlertController,\n    public androidFingerprintAuth: AndroidFingerprintAuth,\n    public app:App,\n    ){\n      this.platform.registerBackButtonAction(()=>{\n        this.navCtrl.popToRoot();\n      });\n      let sloginuserinfo = this.storage.get(StorageProvider.ME_LOGIN_USERINFO);\n      if(sloginuserinfo!=null){\n        let account =sloginuserinfo.account;\n        let openfingerLogin=this.storage.get(StorageProvider.SETTING_FINGER_LOGIN);\n        if(openfingerLogin!=null){\n          if(account==openfingerLogin.account){\n            this.fingerval=true;\n          }else{\n            this.fingerval=false;\n          }\n        }else{\n          this.fingerval=false;\n        }\n        //当本地缓存中记录信息时       \n      }else{\n        this.fingerval=false;\n      }\n\n          \n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad SecuritysetPage');\n    this.events.unsubscribe('wordChangeMessage');\n  }\n  changePassword(){\n    let user={id:this.storage.get(StorageProvider.ME_USERINFO).id,\n               oldPassword:this.storage.get(StorageProvider.ME_LOGIN_USERINFO).password,\n              };\n    this.events.subscribe('wordChangeMessage',(data)=>{\n      this.toastCtrl.create({\n        message:data,\n        duration:1200,\n        position:'top',\n      }).present();\n      // this.events.unsubscribe('wordChangeMessage');\n    });\n    this.events.subscribe('changeSuccess',()=>{\n      var api='/logout';\n             this.httpService.post(api,null,(data)=>{\n              if(data.code==0){\n                  this.alertCtrl.create({\n                    title:'下线通知',\n                    subTitle:'您的密码已修改，请重新登陆',\n                    cssClass:'AlertList2',\n                    buttons:[{\n                      text:'确定',\n                      handler:()=>{\n                        this.storage.remove(StorageProvider.ME_USERINFO); \n                        this.storage.remove(StorageProvider.ME_LOGIN_USERINFO); \n                        this.storage.remove(StorageProvider.HOME_APPAUTHORITY);\n                        this.storage.remove(StorageProvider.SYSTEM_CONFIG);\n                        this.storage.remove(StorageProvider.ALLAPPLICATION);\n                        this.storage.remove(StorageProvider.ISKEEP_PASSWORD);\n                        // this.storage.remove(StorageProvider.ALLAPPLICATION);\n                        this.app.getRootNav().setRoot('LoginPage'); \n                        this.events.unsubscribe('changeSuccess');\n                      }\n                    }]\n                  }).present();\n                     \n              }\n            },null);\n    })\n    let modal:Modal=this.modalCtrl.create('DialogChangepasswordPage',{'userinfo':user});\n    modal.present();\n  }\n\n  fingerOpen(event){\n    console.log(event.checked);\n    if(event.checked){\n      if (this.platform.is('android')||this.platform.is('ios')) {\n        this.isAvailueble(event.checked);\n      }\n    }else{\n        this.fingerval=false;\n        this.storage.remove(StorageProvider.SETTING_FINGER_LOGIN);   \n        let toa = this.toast.create({\n          message: '指纹登录认证已关闭',\n          position: 'middle',\n          duration: 3000\n        })\n        toa.present();   \n    }\n  }\n\n\n  //开启指纹认证\n  isAvailueble(status) {\n    this.androidFingerprintAuth.isAvailable().then((res) => {  \n      if (res.isAvailable) {\n        let sloginuserinfo = this.storage.get(StorageProvider.ME_LOGIN_USERINFO);\n        if (sloginuserinfo != null) {\n          let encryptConfig = {\n            clientId: 'tkyappName',\n            username: sloginuserinfo.account,\n            password: sloginuserinfo.password,\n            locale:'zh_CN',\n            maxAttempts:5,\n            disableBackup:true,\n            dialogTitle:'指纹登录开启',\n          }\n          this.androidFingerprintAuth.encrypt(encryptConfig).then(result => {\n            if (result.withFingerprint) {   \n              let fingeruser={\n                account: sloginuserinfo.account,\n                password: sloginuserinfo.password,\n                token:result.token\n              }\n              this.storage.set(StorageProvider.SETTING_FINGER_LOGIN,fingeruser);                       \n              this.fingerval=true;\n              let toa = this.toast.create({\n                message: '指纹登录认证已开启',\n                position: 'middle',\n                duration: 1000\n              })\n              toa.present();\n            }else{\n              this.fingerval=false;\n              this.storage.remove(StorageProvider.SETTING_FINGER_LOGIN);  \n              let toa = this.toast.create({\n                message: '指纹登录认证失败',\n                position: 'middle',\n                duration: 3000\n              });\n              toa.present();\n            }\n          },error => {\n            this.fingerval=false;\n            this.storage.remove(StorageProvider.SETTING_FINGER_LOGIN);  \n            if (error === this.androidFingerprintAuth.ERRORS.FINGERPRINT_CANCELLED) {\n                console.log(\"FingerprintAuth Dialog Cancelled!\");\n            }else if(error === this.androidFingerprintAuth.ERRORS.FINGERPRINT_ERROR){\n                let toa = this.toast.create({\n                  message: '指纹认证失败',\n                  position: 'middle',\n                  duration: 1000\n                })\n                toa.present();\n            }else {\n                console.log(\"FingerprintAuth Error: \" + error);\n            }\n          })\n        }        \n      }else{\n        this.fingerval=false;\n        this.storage.remove(StorageProvider.SETTING_FINGER_LOGIN);   \n      }\n    }).catch(error => {\n      this.fingerval=false;\n      let toa = this.toast.create({\n        message: '指纹登录认证失败',\n        position: 'middle',\n        duration: 3000\n      });\n      toa.present();\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/me/securityset/securityset.ts","import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { SecuritysetPage } from './securityset';\n\n@NgModule({\n  declarations: [\n    SecuritysetPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SecuritysetPage),\n  ],\n})\nexport class SecuritysetPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/me/securityset/securityset.module.ts"],"sourceRoot":""}